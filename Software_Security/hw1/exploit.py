from pwn import *

bs = None
flag_len = None
with open('tflag', 'rb') as f:
    bs = f.read()
    flag_len = len(bs) / 4
    f.close()

u = make_unpacker(32, endianness='little', sign='unsigned')
edx = 1

flag = ''
for ebx in range(flag_len):
    tmp = (0xcccccccd * (ebx+2))
    eax = tmp & 0xffffffff
    edx = tmp >> 32

    edx >>= 3
    eax = 10 * edx
    edx = ebx + 1
    edx <<= (ebx+2-eax) & 0xff

    flag += chr((u(bs[ebx*4:ebx*4+4]) - 0x2333) // edx)
    #print hex(edx)
print flag
